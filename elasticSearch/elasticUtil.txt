No entanto, Elasticsearch é muito mais do que apenas Lucene e muito mais do que “apenas” pesquisa de texto completo. Também pode ser descrito da seguinte forma:

- Um armazenamento de documentos em tempo real distribuído onde cada campo é indexado e pesquisável

- Um mecanismo de pesquisa distribuído com análises em tempo real

- Capaz de escalar para centenas de servidores e petabytes de dados estruturados e não estruturados


Elasticsearch é orientado a documentos , o que significaque armazena objetos ou documentos inteiros. Ele não apenas os armazena, mas também indexa o conteúdo de cada documento para torná-los pesquisáveis.


--Métodos simples de consulta:

Para fazer isso, usaremos um método de pesquisa leve que é fácil de usar na linha de comando. Este método é frequentemente referido comouma pesquisa de string de consulta , já que passamos a pesquisa como um parâmetro de string de consulta de URL:

GET /megacorp/employee/_search?q=last_name:Smith

Elasticsearch fornece uma linguagem de consulta rica e flexível chamada DSL de consulta , que nos permite construir consultas muito mais complexas e robustas.

--Consulta com dsl

O idioma específico do domínio (DSL) éespecificado usando um corpo de solicitação JSON. Podemos representar a pesquisa anterior para todos os Smiths da seguinte forma:

GET /megacorp/employee/_search
{
    "query" : {
        "match" : {
            "last_name" : "Smith"
        }
    }
}

-- Subir elastic no docker --

docker run -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" docker.elastic.co/elasticsearch/elasticsearch:6.8.19

----

Vamos complicar um pouco a pesquisa. Ainda queremos encontrar todos os funcionários com o sobrenome Smith, mas queremos apenas funcionários com mais de 30 anos.
Nossa consulta mudará um pouco para acomodar um filtro , que nos permite executar pesquisas estruturadas com eficiência:

{
    "query" : {
        "filtered" : {
            "filter" : {
                "range" : {
                    "age" : { "gt" : 30 } 1
                }
            },
            "query" : {
                "match" : {
                    "last_name" : "smith" 2
                }
            }
        }
    }
}

 -- Match trata parecido por exemplo buscar que gosta de escalada:

{
"query" : {
        "match" : {
            "about" : "rock climbing"
        }
    }
}

Irá retornar quem curte rock tbm... para contornarmos isso é preciso buscar a palavra igual por meio do:

"match_phrase" : {
            "about" : "rock climbing"
        }


-- Destacando nossas pesquisas --



{
  "query" : {
    "match_phrase" : {
      "about" : "rock climbing"
    }
  },
  "highlight": {
    "fields" : {
      "about" : {}
    }
  }
}

Dessa forma vai trazer o le contém um trecho de texto do aboutcampo com as palavras correspondentes embrulhadas em <em></em> tags HTML.

--Analytics

Elasticsearch tem uma funcionalidade chamada agregações , quepermitem que você gere análises sofisticadas sobre seus dados.
É semelhante ao GROUP BY SQL, mas muito mais poderoso.



Essas agregações não são pré-calculadas; eles são gerados instantaneamente a partir dos documentos que correspondem à consulta atual


--Natureza distribuida

Embora nosso tutorial tenha dado exemplos de como usar o Elasticsearch, ele não tocou na mecânica.
Elasticsearch é distribuído por natureza e foi projetado para ocultar a complexidade que vem com a distribuição.

Elasticsearch se esforça para esconder a complexidade dos sistemas distribuídos.
Aqui estão algumas das operações que acontecem automaticamente nos bastidores:

Capítulo 2. Vida dentro de um cluster


